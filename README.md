# TPC-H Query 5 Implementation in C++ (Multithreaded)

This project is a multithreaded C++ implementation of **TPC-H Query 5: "Local Supplier Volume"**. It uses raw `.tbl` data files generated by the TPC-H `dbgen` tool and performs fully in-memory processing without any database engine.



##  Project Features

*  **Multithreaded**: Efficient parallel processing of orders.
*  **Fully In-Memory**: No DBMS required.
*  **CLI Interface**: Easily control inputs such as region, date range, and thread count.
*  **Sorted Output**: Returns revenue per nation, sorted in descending order.
*  **Raw TPC-H `.tbl` File Support**.



## Folder Structure

```
project_tpch/
├── assets/
│   ├── schema_types.h         # Struct definitions for all tables
│   ├── data_loader.h          # Function declarations for loading tables
│   └── cliconfig_parser.h     # CLI argument parser header
│
├── main/
│   ├── data_loader.cpp        # Loads data from .tbl files
│   ├── cliconfig_parser.cpp   # CLI argument parsing logic
│   └── index.cpp              # Main logic (query processing, threading, output)
│
├── tbl_data/                  # Contains .tbl files (from dbgen)
├── result.txt                 # Output result file
└── README.md                  # Project documentation
```



##  Requirements

* C++17 or later
* `make` or any modern C++ build system
* `.tbl` data files generated using the [TPC-H dbgen tool](https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf)



##  Build & Run Instructions

### 1. Clone the Repository

```bash
git clone https://github.com/yourusername/project_tpch.git
cd project_tpch
```

### 2. Generate `.tbl` Files (Using `dbgen`)

If you haven’t already, generate `.tbl` files using TPC-H's `dbgen` and place them in `tbl_data/`.

```bash
mkdir tbl_data
# Place files like nation.tbl, region.tbl, customer.tbl, etc. here
```

### 3. Compile the Project

You can use `g++` or a `Makefile`. Example:

```bash
g++ -std=c++17 main/index.cpp main/data_loader.cpp main/cliconfig_parser.cpp -o tpch_query
```

### 4. Run the Program

```bash
./tpch_query \
  --data ./tbl_data/ \
  --output result.txt \
  --region EUROPE \
  --start 1995-01-01 \
  --end 1996-01-01 \
  --threads 4
```

### Example CLI Flags

* `--data` : Path to folder containing `.tbl` files
* `--output` : Output file path
* `--region` : Name of region to filter (e.g., `EUROPE`)
* `--start` / `--end` : Order date range (inclusive start, exclusive end)
* `--threads` : Number of threads to use



##  Output Format

The result (written to `result.txt`) lists nations and their corresponding revenue in descending order:

```
Final Revenue by Nations:
GERMANY: 17489230.12
FRANCE: 16344123.87
...
```



##  References

* [TPC-H Benchmark Specification](https://www.tpc.org/tpc_documents_current_versions/pdf/tpc-h_v3.0.1.pdf)
* Query 5: *Local Supplier Volume*



##  Future Improvements

* Add support for other TPC-H queries
* Include benchmark graphs for different thread counts
* JSON/CSV output option



